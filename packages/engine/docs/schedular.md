# scheduler

scheduler 的基本思路是把 paint 和 digest 分成两个阶段。因为每次都可能有多个节点更新，所以一次性 paint 完。
一次性 digest。而不是一个一个地 paint、digest。

这样的好处在于，有时候父节点和子节点都要更新，而在父节点更新的过程中，可能子节点被移除了，或者发现不要更新了。
这样就可以在 paint 阶段都发现合并，后面就可以跳过一些 digest 了。

在 painter 中使用了一个叫做 trackingTree 的数据结构来保持组件的数据结果，保障层级高节点先 paint，因为它会影响子节点。

## 关于局部更新的能力

scheduler 需要把组件更新和 节点更新合并起来，因为如果组件要更新，那么单一节点更新就没有意义了。

所以除了提供 trackingTree 用来记录要更新的 cnode 之外，还有一个数据结构来记录需要更新的局部。

当更新玩所有 cnode 之后，再开始把“仍然需要”更新的局部进行更新。为什么强调“仍然需要”？因为有可能有的不需要更新了，
例如 cnode 已经整体更新了，或者被销毁了。
